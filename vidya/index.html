<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="google-site-verification" content="cSG8wHPog9VSS3uC358SQbxNSZ1x0O_cclAQXxR36W0" />
  <title>VIDYA - Home</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    /* 1. RESET & BASICS */
    * { box-sizing: border-box; }
    body { font-family: 'Segoe UI', sans-serif; background: #fdfdfd; margin: 0; padding: 0; }
    
    /* 2. PURPLE HERO BANNER */
    .hero-banner {
        background: linear-gradient(135deg, #6e1bd6 0%, #ff2c92 100%);
        padding: 20px 20px 80px 20px; 
        color: white;
        border-radius: 0 0 30px 30px;
        box-shadow: 0 4px 20px rgba(110, 27, 214, 0.2);
        position: relative;
    }

    .nav-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; }
    .site-logo { font-size: 1.8rem; font-weight: 800; letter-spacing: 1px; }
    .user-actions { display: flex; align-items: center; gap: 15px; }
    
    .profile-btn {
        width: 45px; height: 45px; 
        background: rgba(255,255,255,0.2); 
        border: 2px solid rgba(255,255,255,0.4);
        border-radius: 50%; 
        display: flex; align-items: center; justify-content: center; 
        cursor: pointer; transition: 0.2s;
    }
    .profile-btn:hover { background: white; transform: scale(1.1); }
    .profile-btn:hover i { color: #6e1bd6; }
    .profile-btn i { font-size: 1.1rem; color: white; }

    /* SEARCH BAR */
    .search-container {
        position: relative; 
        width: 100%;
        max-width: 650px;
        margin: 0 auto; 
    }

    .search-box {
        background: white; width: 100%; height: 60px;
        border-radius: 50px; display: flex; align-items: center;
        padding: 0 10px 0 25px; 
        box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        transition: transform 0.2s;
        position: relative;
        z-index: 101; 
    }
    .search-box:hover { transform: translateY(-2px); }
    .search-box input { border: none; outline: none; flex: 1; font-size: 1.1rem; color: #333; }
    .search-box button {
        background: #6e1bd6; color: white; border: none; border-radius: 50px;
        padding: 12px 30px; font-weight: bold; font-size: 1rem; cursor: pointer;
    }

    /* LIVE SEARCH DROPDOWN */
    .live-results {
        position: absolute;
        top: 70px; left: 0; right: 0;
        background: white;
        border-radius: 20px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        padding: 15px;
        z-index: 100;
        display: none; 
        max-height: 400px;
        overflow-y: auto;
    }
    .live-results.active { display: block; }
    
    .result-item {
        display: flex; align-items: center; gap: 15px;
        padding: 10px; border-radius: 10px;
        text-decoration: none; color: #333;
        transition: 0.2s; border-bottom: 1px solid #f5f5f5;
    }
    .result-item:hover { background: #f8f9fa; }
    .result-item img { width: 40px; height: 40px; object-fit: contain; border-radius: 5px; background: #eee; }
    .result-info h4 { margin: 0; font-size: 0.95rem; font-weight: 600; }
    .result-info p { margin: 2px 0 0; font-size: 0.8rem; color: #777; }

    /* 3. SLIDING PANEL (Menu) */
    .panel-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.5); display: none; z-index: 2000;
        backdrop-filter: blur(3px);
    }
    .profile-panel {
        position: fixed; top: 0; right: -400px; width: 320px; height: 100%;
        background: white; z-index: 2100; transition: right 0.3s ease;
        box-shadow: -5px 0 30px rgba(0,0,0,0.2);
        display: flex; flex-direction: column;
    }
    .profile-panel.open { right: 0; }

    .panel-header { background: linear-gradient(135deg, #6e1bd6, #ff2c92); padding: 30px; color: white; }
    .menu-link { display: flex; align-items: center; padding: 15px; color: #333; text-decoration: none; font-weight: 600; border-radius: 10px; margin-bottom: 5px; transition: 0.2s; }
    .menu-link:hover { background-color: #f5f5f5; color: #6e1bd6; }
    .menu-link i { width: 25px; color: #6e1bd6; }
    .btn-logout { width: 100%; padding: 15px; background: #fff5f5; color: #d63031; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; text-align: left; display: flex; align-items: center; margin-top: 20px; }
    
    /* 4. CONTENT SECTIONS */
    .container { max-width: 1100px; margin: 40px auto; padding: 0 20px; }
    
    /* HEADER WITH ACTION BUTTON */
    .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .section-title { font-size: 1.4rem; color: #333; display: flex; align-items: center; gap: 10px; margin: 0; }
    .section-title::before { content: ''; display: block; width: 5px; height: 25px; background: #6e1bd6; border-radius: 5px; }

    /* EDIT/BROWSE BUTTON STYLE */
    .edit-btn {
        background: white; color: #6e1bd6; 
        border: 1px solid #6e1bd6; padding: 8px 16px; 
        border-radius: 20px; text-decoration: none; 
        font-weight: 600; font-size: 0.9rem; transition: 0.2s;
    }
    .edit-btn:hover { background: #6e1bd6; color: white; }

    /* --- UPDATED PREFERENCES CARDS --- */
    .pref-grid { 
        display: grid; 
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
        gap: 20px; 
    }
    
    .pref-card { 
        background: white; 
        padding: 25px 20px; 
        border-radius: 12px; 
        box-shadow: 0 5px 15px rgba(0,0,0,0.08); /* Stronger shadow */
        border-left: 5px solid #6e1bd6; /* Purple accent border */
        transition: transform 0.2s ease;
        border-top: 1px solid #f0f0f0;
        border-right: 1px solid #f0f0f0;
        border-bottom: 1px solid #f0f0f0;
    }
    .pref-card:hover { transform: translateY(-3px); }
    
    .pref-card h4 { 
        margin: 0 0 8px 0; 
        font-size: 0.85rem; 
        color: #6e1bd6; /* Purple text */
        font-weight: 700;
        text-transform: uppercase; 
        letter-spacing: 0.5px;
    }
    .pref-card p { 
        margin: 0; 
        font-weight: 700; 
        color: #2d3748; /* Darker black */
        font-size: 1.1rem; 
    }
    .not-set { color: #a0aec0; font-style: italic; font-weight: 400; }

    /* College List (Horizontal Scroll) */
    .college-list { display: flex; gap: 20px; overflow-x: auto; padding: 10px 5px 25px 5px; scroll-behavior: smooth; }
    .college-list::-webkit-scrollbar { height: 8px; }
    .college-list::-webkit-scrollbar-thumb { background: #dcdcdc; border-radius: 10px; }
    
    .college-card { min-width: 240px; background: #6e1bd6; color: white; padding: 25px 20px; border-radius: 20px; text-align: center; box-shadow: 0 10px 25px rgba(110, 27, 214, 0.2); transition: 0.3s; display: flex; flex-direction: column; align-items: center; text-decoration: none; position: relative; }
    .college-card:hover { transform: translateY(-8px); box-shadow: 0 15px 35px rgba(110, 27, 214, 0.35); }
    .college-card img { width: 80px; height: 80px; object-fit: contain; background: white; padding: 8px; border-radius: 15px; margin-bottom: 15px; }
    .college-card h3 { font-size: 1.1rem; font-weight: 700; margin: 0 0 8px 0; line-height: 1.3; }
    .college-card p { font-size: 0.9rem; opacity: 0.9; margin: 0 0 20px 0; }
    .view-btn { margin-top: auto; background: white; color: #6e1bd6; padding: 8px 20px; border-radius: 20px; font-weight: bold; font-size: 0.9rem; }

    /* --- UPDATED CONTENT HUB CARDS --- */
    .hub-grid { 
        display: grid; 
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); 
        gap: 20px; 
    }
    
    .hub-card { 
        background: white; 
        padding: 25px 15px; 
        text-align: center; 
        border-radius: 16px; 
        border: 2px solid #f3f4f6; 
        text-decoration: none; 
        color: inherit; 
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0,0,0,0.02);
    }
    
    .hub-card h3 {
        margin: 0 0 5px 0;
        font-size: 1.4rem;
        font-weight: 800;
        color: #2d3748;
        transition: color 0.3s;
    }
    
    .hub-card span {
        color: #718096;
        font-size: 0.85rem;
        font-weight: 500;
        transition: color 0.3s;
    }

    /* Hover Effect: Turn Purple */
    .hub-card:hover { 
        background: #6e1bd6; 
        border-color: #6e1bd6; 
        transform: translateY(-5px); 
        box-shadow: 0 15px 30px rgba(110, 27, 214, 0.25);
    }
    
    .hub-card:hover h3, 
    .hub-card:hover span {
        color: white !important;
    }
    
    @media (max-width: 600px) {
        .hero-banner { padding: 20px 20px 60px 20px; }
        .search-box { height: 50px; }
    }
  </style>
</head>
<body>

    <div class="hero-banner">
        <div class="nav-row">
            <div class="site-logo">VIDYA</div>
            <div class="user-actions">
                <span id="user-display-name" style="font-weight:600; font-size:0.9rem;">Hello!</span>
                <div class="profile-btn" onclick="openMenu()" title="Open Menu">
                    <i class="fas fa-bars"></i>
                </div>
            </div>
        </div>

        <div class="search-container">
            <div class="search-box">
                <i class="fas fa-search" style="color: #ccc;"></i>
                <input type="text" id="searchInput" placeholder="Search for colleges, courses..." autocomplete="off">
                <button onclick="goToSearchPage()">Search</button>
            </div>
            
            <div id="liveResults" class="live-results">
                </div>
        </div>
    </div>

    <div id="panelOverlay" class="panel-overlay" onclick="closeMenu()"></div>
    <aside id="profilePanel" class="profile-panel">
        <div class="panel-header">
            <h2 id="menu-user-name" style="margin:0;">Welcome!</h2>
            <p style="opacity:0.8; margin-top:5px;">Your Account</p>
        </div>
        <div style="padding: 20px;">
            <a href="profile.html" class="menu-link"><i class="fas fa-user-edit"></i> Edit Profile</a>
            <a href="favorites.html" class="menu-link"><i class="fas fa-heart"></i> Favorites</a>
            <div style="height:1px; background:#eee; margin: 20px 0;"></div>
            <button onclick="handleLogout()" class="btn-logout"><i class="fas fa-sign-out-alt me-2"></i> Logout</button>
        </div>
    </aside>

    <div class="container">
        
        <div class="section-header">
            <div class="section-title">Your Preferences</div>
            <a href="profile.html" class="edit-btn">
            Edit Details
            </a>
        </div>

        <div class="pref-grid">
            <div class="pref-card"><h4>Stream</h4><p id="pref-stream">Loading...</p></div>
            <div class="pref-card"><h4>Programme</h4><p id="pref-programme">Loading...</p></div>
            <div class="pref-card"><h4>Location</h4><p id="pref-location"><span class="not-set">Not set</span></p></div>
            <div class="pref-card"><h4>University</h4><p id="pref-university"><span class="not-set">Not set</span></p></div>
        </div>

        <br><br>

        <div class="section-header">
            <div class="section-title">Top Colleges (Ranked)</div>
            <a href="listing.html" class="edit-btn">
             Browse Colleges
            </a>
        </div>
        
        <div class="college-list" id="college-list">
    
<a href="college.html?id=IPVpoNYv2Cp32rRt3VuS" class="college-card">
        <img src="assets/colleges/nit_logo.jpg" alt="NIT" > <h3>NIT Calicut</h3>
        <p>Kozhikode</p>
        <div class="view-btn">View Details</div>
    </a>

    <a href="college.html?id=wXULd3LZrw9jAb13Ksxi" class="college-card">
        <img src="assets/colleges/iit_logo.jpg" alt="IIT" >
        <h3>IIT Palakkad</h3>
        <p>Palakkad</p>
        <div class="view-btn">View Details</div>
    </a>

    <a href="college.html?id=CbkeJ65fNKkDZa4irWTK" class="college-card">
        <img src="assets/colleges/gect_logo.jpg" alt="GEC">
        <h3>GEC Thrissur</h3>
        <p>Thrissur</p>
        <div class="view-btn">View Details</div>
    </a>
    
    <a href="college.html?id=As0oeVdcyYtF1lXk1sTv" class="college-card">
        <img src="assets/colleges/st_thomas_logo.jpg" alt="GEC">
        <h3>St. Thomas College Thrissur</h3>
        <p>Thrissur</p>
        <div class="view-btn">View Details</div>
    </a>

        </div>

        <br><br>

        <div class="section-title">Content Hub</div>
        <div class="hub-grid">
            <a href="course.html?c=bca" class="hub-card"><h3>BCA</h3><span>Computer Applications</span></a>
            <a href="course.html?c=bba" class="hub-card"><h3>BBA</h3><span>Business Admin</span></a>
            <a href="course.html?c=bcom" class="hub-card"><h3>B.Com</h3><span>Commerce</span></a>
            <a href="course.html?c=mba" class="hub-card"><h3>MBA</h3><span>Management</span></a>
            <a href="course.html?c=mca" class="hub-card"><h3>MCA</h3><span>Masters Comp. App</span></a>
            <a href="course.html?c=mcom" class="hub-card"><h3>M.Com</h3><span>Masters of Commerce</span></a>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, collection, getDocs, orderBy, query, limit } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBt5DvViwm5ls_B4CWKYIYhMutJJ9opw_Y",
            authDomain: "vidyaproject-c4a1d.firebaseapp.com",
            projectId: "vidyaproject-c4a1d",
            storageBucket: "vidyaproject-c4a1d.firebasestorage.app",
            messagingSenderId: "637214484165",
            appId: "1:637214484165:web:f23e84c08cd6069f6fb2ac",
            measurementId: "G-647MPHBDGW"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let allCollegesCache = [];

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                // Admin Check (Optional)
                const userSnap = await getDoc(doc(db, "users", user.uid));
                if (userSnap.exists() && userSnap.data().role === "admin") {
                    window.location.href = "admin-dashboard.html";
                    return;
                }

                const name = user.displayName || user.email.split('@')[0];
                document.getElementById('user-display-name').innerText = "Hello, " + name;
                document.getElementById('menu-user-name').innerText = "Welcome, " + name;

                loadUserPreferences(user.uid);
                loadAllCollegesForSearch();
            } else {
                window.location.href = "login.html";
            }
        });

        async function loadUserPreferences(uid) {
            try {
                const userDoc = await getDoc(doc(db, "users", uid));
                if (userDoc.exists()) {
                    const data = userDoc.data();
                    const setText = (id, val) => {
                        const el = document.getElementById(id);
                        if(el) { el.innerText = val || "Not set"; if(val) el.classList.remove('not-set'); }
                    };
                    setText('pref-stream', data.stream);
                    setText('pref-programme', data.degree);
                    setText('pref-location', data.location);
                    setText('pref-university', data.university);
                }
            } catch (error) { console.error(error); }
        }

        // Note: loadTopColleges() is commented out to preserve your Hardcoded List
        // async function loadTopColleges() { ... }
        // loadTopColleges();

        async function loadAllCollegesForSearch() {
            const snap = await getDocs(collection(db, "colleges"));
            allCollegesCache = [];
            snap.forEach(doc => {
                const d = doc.data();
                allCollegesCache.push({
                    id: doc.id,
                    name: d.name,
                    district: d.district || "",
                    logo: d.logo_path || 'assets/default-college.png'
                });
            });
        }

        const searchInput = document.getElementById('searchInput');
        const resultsBox = document.getElementById('liveResults');

        searchInput.addEventListener('input', showLiveResults);
        searchInput.addEventListener('focus', showLiveResults);
        
        document.addEventListener('click', (e) => {
            if (!searchInput.contains(e.target) && !resultsBox.contains(e.target)) {
                resultsBox.classList.remove('active');
            }
        });

        function showLiveResults() {
            const val = searchInput.value.toLowerCase();
            resultsBox.innerHTML = "";
            
            const matches = allCollegesCache.filter(c => 
                c.name.toLowerCase().includes(val) || c.district.toLowerCase().includes(val)
            ).slice(0, 5); 

            if (matches.length > 0) {
                resultsBox.classList.add('active');
                matches.forEach(c => {
                    resultsBox.innerHTML += `
                        <a href="college.html?id=${c.id}" class="result-item">
                            <img src="${c.logo}" alt="logo">
                            <div class="result-info">
                                <h4>${c.name}</h4>
                                <p>${c.district}</p>
                            </div>
                        </a>
                    `;
                });
                resultsBox.innerHTML += `
                    <div style="text-align:center; padding-top:10px; border-top:1px solid #eee;">
                        <a href="#" onclick="goToSearchPage()" style="color:#6e1bd6; font-weight:bold; text-decoration:none;">See all results</a>
                    </div>
                `;
            } else {
                if(val.length > 0) {
                    resultsBox.classList.add('active');
                    resultsBox.innerHTML = `<div style="padding:15px; text-align:center; color:#777;">No colleges found</div>`;
                } else {
                    resultsBox.classList.remove('active');
                }
            }
        }

        window.handleLogout = async function() { await signOut(auth); window.location.href = "login.html"; }
        window.goToSearchPage = function() {
            const query = document.getElementById('searchInput').value;
            window.location.href = `listing.html?q=${encodeURIComponent(query)}`;
        }
    </script>

    <script>
        function openMenu() { document.getElementById('profilePanel').classList.add('open'); document.getElementById('panelOverlay').style.display = 'block'; }
        function closeMenu() { document.getElementById('profilePanel').classList.remove('open'); document.getElementById('panelOverlay').style.display = 'none'; }
    </script>
    <footer style="padding:28px;text-align:center;color:#666">2026 VIDYA Project | Developed by Samson Varghese, Ewin Job, Jeremiah AR</footer>
</body>
</html>